---

### x_ are macros: https://bitbucket.org/mindera/mind-meta-jjb-root for more information


###############
### PROJECT
- project:
    name: 'telemetron-relay'
    project_version: '0.1.0'
    giturl: git@bitbucket.org:mindera/telemetry-relay.git
    jobs:
      - '{name}-build'


###############
### DEFAULTS
- defaults:
    name: global
    description: 'Do NOT edit this job through the web! '
    project-type: freestyle
    node: ordinary
    wrappers:
      - timestamps
      - ansicolor


###############
### TEMPLATES

# Build
- job-template:
    name: "{name}-build"

    properties:
      - x_pipeline__build
      - inject:
          properties-content: |
              NEXUS_USERNAME=deployment
              NEXUS_PASSWORD=deployment123
              NEXUS_URL=http://nexus.internal.mindera.com/content/repositories/yum_releases

    wrappers:
      - timestamps
      - delivery-pipeline:
          version-template: '{project_version}-$BUILD_NUMBER'
          set-display-name: true

    scm:
      - git_shallow_clone_v1:
          url: '{giturl}'
          excluded-region: '.jenkins'

    triggers:
      - pollscm: "H/5 * * * *"

    builders:
      - shell: |
          npm install
          grunt release

